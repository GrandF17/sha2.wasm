#include <iostream>
#include <iomanip>
#include <vector>

#include "./lib/sha224.class.cpp"
#include "./lib/hmac.class.cpp"

static std::vector<uint8_t> hex(const std::string &s) {
    std::vector<uint8_t> out;
    out.reserve(s.size() / 2);

    for (size_t i = 0; i < s.size(); i += 2) {
        out.push_back(
            static_cast<uint8_t>(std::stoul(s.substr(i, 2), nullptr, 16))
        );
    };
    return out;
};

int main() {
    auto key = hex("aa616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117");
    auto msg = hex("aa616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117");

    HMAC<SHA224_HASH> hmac;
    uint8_t out[SHA224_HASH::digest_size];

    hmac.init(key.data(), key.size());
    hmac.update(msg.data(), msg.size());
    hmac.digest(out);

    for (int i = 0; i < SHA224_HASH::digest_size; ++i) {
        std::cout
            << std::hex
            << std::setw(2)
            << std::setfill('0')
            << static_cast<int>(out[i])
            << " ";
    };
    std::cout << std::endl;

    hmac.destroy();
};