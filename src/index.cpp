#include <iostream>
#include <iomanip>
#include <cstdint>
#include <chrono>
#include <vector>

#include "./lib/core/sha224.hpp"
#include "./lib/core/sha256.hpp"
#include "./lib/core/sha384.hpp"
#include "./lib/core/sha512.hpp"

using namespace std;

int main() {
    SHA512::CTX c;

    size_t msg_len = 129;
    uint8_t msg[msg_len] = {
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 0x63, 0x62, 0x61, 0x60, 
        0x72
    };

    size_t out_len = 48;
    uint8_t out[out_len] = {0};

    SHA384::init(c);
    SHA384::update(c, msg, msg_len);
    SHA384::digest(c, out);
    SHA384::destroy(c);

    for (int i = 0; i < out_len; ++i) {
        cout
            << hex
            << setw(2)
            << setfill('0')
            << static_cast<int>(out[i])
            << " ";
    };
    cout << endl;
    
    return 0;
};